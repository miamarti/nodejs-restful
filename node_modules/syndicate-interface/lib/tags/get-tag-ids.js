
/**
 * Get the cached tag ids for a thing and a type.
 */

var ObjectID = require('mongodb').ObjectID

var redis = require('../databases/redis')

module.exports = function* (thing, type, collection) {
  var key = 'tags:' + thing._id.toHexString() + ':' + type + ':' + collection
  var ids = yield redis.zrevrange(key)
  return ids.map(toOID)
}

function toOID(x) {
  return new ObjectID(x)
}
