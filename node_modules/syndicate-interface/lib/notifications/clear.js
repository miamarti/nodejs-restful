
/**
 * Clear all a user's notifications.
 */

var mdb = require('../databases/mongodb')

module.exports = function* (user) {
  var promises = []

  promises.push(mdb.users.findOne('_id', user._id).set('count.notifications', 0))

  promises.push(mdb.notifications.find({
    'user._id': user._id,
    deleted: false,
    read: false
  }).set('read', true).set('date.read', new Date()))

  yield promises
}
